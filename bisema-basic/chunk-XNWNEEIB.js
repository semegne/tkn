import{a as te,c as ie}from"./chunk-HSM5X2YU.js";import{a as Y,b as Z}from"./chunk-HR7DVQT6.js";import{q as X}from"./chunk-G7Y2ZS3Y.js";import{a as ee,b as ne}from"./chunk-Y6CEYV4J.js";import"./chunk-64QROMKM.js";import{$a as z,Aa as p,Da as B,F as m,G as u,H as D,Ha as $,Na as E,Oa as s,Pa as I,Qa as b,Ra as j,U as T,V as q,X as o,Ya as x,Za as P,_a as U,ab as v,bb as S,ca as M,cb as A,ga as N,ha as C,kb as K,la as F,lb as L,ma as l,mb as R,nb as G,ob as H,pb as J,qa as a,qb as Q,ra as c,rb as W,sa as h,ta as k,ua as V,va as O,wa as y,za as g}from"./chunk-RPBBG52S.js";import"./chunk-4CLCTAJ7.js";var ae=r=>({"tbody-custom":r}),f=r=>({"bg-red":r}),ce=(r,t)=>({"clr-red":r,"text-success":t}),le=(r,t,e)=>({option:r,index:t,margin:5,item:e}),se=(r,t,e,i)=>({option:r,index:t,margin:e,item:i}),pe=(r,t)=>({"bg-purple text-white":r,"clr-grey":t});function de(r,t){r&1&&(a(0,"span"),s(1," / price:0"),c())}function _e(r,t){if(r&1&&(a(0,"span"),s(1),c()),r&2){let e=p().index,i=p(2).$implicit;o(),j(" -> ",i.finish_labels[e]," | ",i.finish_prices[e],"")}}function me(r,t){if(r&1&&(a(0,"div"),O(1,40),c()),r&2){let e=t.$implicit,i=p().index,n=p(2).$implicit;p();let d=E(33);o(),l("ngTemplateOutlet",d)("ngTemplateOutletContext",U(2,le,e,i,n))}}function ue(r,t){if(r&1){let e=y();a(0,"div",35)(1,"a",36),g("click",function(){let n=m(e).index,d=p(2).$implicit,_=p();return u(_.finishCollapseToggle(d,n))}),h(2,"i",37),s(3),C(4,de,2,0,"span",15)(5,_e,2,2,"span",15),c(),a(6,"div",38,4),C(8,me,2,6,"div",39),c()()}if(r&2){let e=t.$implicit,i=t.index,n=p(2).$implicit;o(),l("ngClass",P(6,ce,n.finish_labels[i].trim()=="??",n.finish_labels[i].trim()!="??")),o(2),b(" ",e.description," "),o(),l("ngIf",n.finish_prices[i]==0),o(),l("ngIf",n.finish_prices[i]!=0),o(),l("ngbCollapse",e.collapse),o(2),l("ngForOf",e.options)}}function ge(r,t){if(r&1&&(k(0,29),C(1,ue,9,9,"div",34),V()),r&2){let e=p().$implicit;o(),l("ngForOf",e.product.groups)}}function xe(r,t){if(r&1){let e=y();a(0,"tr",17)(1,"td",13)(2,"b"),s(3),c()(),a(4,"td",13)(5,"input",18,1),g("keyup",function(){let n=m(e).index,d=E(6),_=p();return u(_.changeTagName(n,d.value))}),c()(),a(7,"td",13)(8,"input",19,2),g("click",function(){let n=m(e).$implicit,d=p();return u(d.checkBox(n))}),c()(),a(10,"td",20),h(11,"img",21),v(12,"lowercase"),c(),a(13,"td",13),s(14),v(15,"uppercase"),c(),a(16,"td",13),s(17),v(18,"uppercase"),c(),a(19,"td",13)(20,"div",22)(21,"p",23),s(22),c(),a(23,"a",24),g("click",function(){let n=m(e).index,d=p();return u(d.editFinish(n))}),h(24,"i",25),c()(),C(25,ge,2,1,"ng-container",26),c(),a(26,"td",27)(27,"div",28)(28,"div")(29,"p",29),s(30),c()()()(),a(31,"td",30)(32,"div",31)(33,"button",32),g("click",function(){let n=m(e).index,d=p();return u(d.stepDown(n))}),s(34,"-"),c(),a(35,"input",33,3),g("keyup",function(){let n=m(e).index,d=E(36),_=p();return u(_.changePrice(n,d.value))}),c(),a(37,"button",32),g("click",function(){let n=m(e).index,d=p();return u(d.stepUp(n))}),s(38,"+"),c()()(),a(39,"td",13),s(40),v(41,"currency"),c(),a(42,"td",13),s(43),v(44,"currency"),c()()}if(r&2){let e=t.$implicit,i=t.index,n=p();o(),l("ngClass",x(36,f,e.order_code.trim().includes("??"))),o(2),b("",i+1,")"),o(),l("ngClass",x(38,f,e.order_code.trim().includes("??"))),o(),l("value",e.tag_name),o(2),l("ngClass",x(40,f,e.order_code.trim().includes("??"))),o(3),l("ngClass",x(42,f,e.order_code.trim().includes("??"))),o(),$("src","",n.baseUrl,"",e.product.company_code,"/",S(12,26,e.product.catalogue_code),"/prod_icons/",e.product.label,"_3d.png",q),o(2),l("ngClass",x(44,f,e.order_code.trim().includes("??"))),o(),I(S(15,28,e.product.company_code)),o(2),l("ngClass",x(46,f,e.order_code.trim().includes("??"))),o(),I(S(18,30,e.product.catalogue_code)),o(2),l("ngClass",x(48,f,e.order_code.trim().includes("??"))),o(3),b(" ",e.order_code," "),o(3),l("ngIf",e.edit),o(),l("ngClass",x(50,f,e.order_code.trim().includes("??"))),o(4),I(e.product.name),o(),l("ngClass",x(52,f,e.order_code.trim().includes("??"))),o(4),B("value",e.qty),o(4),l("ngClass",x(54,f,e.order_code.trim().includes("??"))),o(),I(S(41,32,n.getTotalPrice(e))),o(2),l("ngClass",x(56,f,e.order_code.trim().includes("??"))),o(),I(S(44,34,e.qty*n.getTotalPrice(e)))}}function fe(r,t){if(r&1&&(a(0,"tr"),h(1,"td",41),a(2,"td",42),s(3,"Grand Total"),c(),a(4,"td",42),s(5),v(6,"currency"),c()()),r&2){let e=p();o(5),b(" ",S(6,1,e.grandTotal)," ")}}function Ce(r,t){if(r&1){let e=y();a(0,"div",43)(1,"button",44),g("click",function(){m(e);let n=p();return u(n.removeItem())}),h(2,"i",45),s(3," Delete "),c(),a(4,"button",46),g("click",function(){m(e);let n=p();return u(n.finishEdit())}),h(5,"i",25),s(6," Finish Editing "),c()()}if(r&2){let e=p();o(),l("disabled",e.deleteItem),o(3),l("disabled",e.finishEditing)}}function he(r,t){if(r&1&&(a(0,"div"),O(1,40),c()),r&2){let e=t.$implicit,i=p(2),n=i.index,d=i.margin,_=i.item;p();let w=E(33);o(),l("ngTemplateOutlet",w)("ngTemplateOutletContext",z(2,se,e,n,d+5,_))}}function ye(r,t){if(r&1){let e=y();k(0),a(1,"a",48),g("click",function(){m(e);let n=p().option;return u(n.sub_group.collapse=!n.sub_group.collapse)}),s(2),c(),a(3,"div",38,5),C(5,he,2,7,"div",39),c(),V()}if(r&2){let e=p(),i=e.option,n=e.margin;o(),F("style","margin-left: ",n,"px;",T),o(),b(" ",i.sub_group.description," "),o(),l("ngbCollapse",i.sub_group.collapse),o(2),l("ngForOf",i.sub_group.options)}}function be(r,t){if(r&1){let e=y();a(0,"a",49),g("click",function(){m(e);let n=p(),d=n.option,_=n.index,w=n.item,oe=p();return u(oe.finish(w,d.name,_,d.price))}),s(1),c()}if(r&2){let e=p(),i=e.option,n=e.index,d=e.margin,_=e.item;F("style","margin-left: ",d,"px;",T),l("ngClass",P(4,pe,i.name==_.finish_labels[n],i.name!=_.finish_labels[n])),o(),b(" ",i.description," ")}}function ve(r,t){if(r&1&&C(0,ye,6,5,"ng-container",15)(1,be,2,7,"a",47),r&2){let e=t.option;l("ngIf",e.subgroup_id),o(),l("ngIf",!e.subgroup_id)}}var re=class r extends ne{baseUrl=ee.media_url;cart=[];selectedIndex=[];grandTotal=null;deleteItem=!0;finishEditing=!0;onDrop(t){this._mainService.getProduct(t.element.data.product_id).subscribe({next:e=>{let i=e.data;i.finish_labels=new Array(i.groups.length).fill(" ??"),i.finish_prices=new Array(i.groups.length).fill(0);let n=i.finish_labels.toString();n=n.replace(/,/g,"");let d={product_id:i.id,tag_name:"",order_code:i.label+n,finish_labels:i.finish_labels,finish_prices:i.finish_prices,qty:1};this._cartService.add(d).subscribe({next:_=>{this.getCart(),this.success(_.message),this._busService.sendShowCart()}})}})}changeTagName(t,e){this.cart[t].tag_name=e,this.update(this.cart[t])}checkBox(t){if(this.selectedIndex.find(i=>i==t)==null)this.selectedIndex.push(t);else{let i=this.selectedIndex.findIndex(n=>n==t);this.selectedIndex.splice(i,1)}this.deleteItem=this.selectedIndex.length==0}editFinish(t){let e=this.cart.findIndex(i=>i.edit==!0);e!=-1&&(this.cart[e].edit=!1),this.cart[t].edit=!0,this.finishEditing=!1}finishCollapseToggle(t,e){t.product?.groups.forEach((i,n)=>{n==e?i.collapse=!i.collapse:i.collapse=!0})}finish(t,e,i,n){t.finish_labels[i]=e,t.finish_prices[i]=n,t.order_code=t.product.label+t.finish_labels.toString().replace(/,/g,""),this.update(t)}stepDown(t){this.cart[t].qty!=1&&(this.cart[t].qty-=1,this.update(this.cart[t]))}stepUp(t){this.cart[t].qty+=1,this.update(this.cart[t])}changePrice(t,e){e>=1&&(this.cart[t].qty=e,this.update(this.cart[t]))}removeItem(){let t=this.selectedIndex.length-1;this.selectedIndex.forEach((e,i)=>{this._cartService.delete(e.id).subscribe({next:n=>{this._busService.sendShowCart(),t==i&&(this.success(n.message),this.getCart(),this.selectedIndex=[])},error:n=>{console.log(`Something went wrong while delete the cart items. Error details: ${JSON.stringify(n)}`)}})})}finishEdit(){this.cart.forEach(t=>{t.edit=!1})}update(t){let e={finish_labels:t.finish_labels,finish_prices:t.finish_prices,qty:t.qty,tag_name:t.tag_name,order_code:t.order_code,_method:"PATCH"};this._cartService.update(e,t.id).subscribe({next:i=>{this.success(i.message)}})}getCart(){this._cartService.getCart().subscribe({next:t=>{t.data,this.loadCartDetails(t.data)}})}loadCartDetails(t){this.cart=[];let e=0;t.length>0&&t.forEach(i=>{i.edit=!1,e=e+ +(i.qty*this.getTotalPrice(i)),this.cart.push(i)}),this.grandTotal=parseFloat(e.toString()).toFixed(2)}getTotalPrice(t){let e=t.product.price;for(let i=0;i<t.finish_prices.length;i++)e=e+t.finish_prices[i];return e=parseFloat(e).toFixed(2),e}ngOnInit(){this.getCart()}static \u0275fac=(()=>{let t;return function(i){return(t||(t=D(r)))(i||r)}})();static \u0275cmp=M({type:r,selectors:[["app-cart"]],features:[N],decls:34,vars:6,consts:[["myFragment",""],["tagInput",""],["cartCheckboxes",""],["qtyInput",""],["finishCollapse","ngbCollapse"],["subfinishCollapse","ngbCollapse"],[1,"mt-2","pt-2","text-center"],[1,"border-dark"],[1,"table","table-bordered",3,"treeDrop"],[1,"thead-light"],[1,"text-center"],["scope","col"],["scope","col",1,"bordNone"],[3,"ngClass"],["class","text-center data",4,"ngFor","ngForOf"],[4,"ngIf"],["class","col-12 text-end",4,"ngIf"],[1,"text-center","data"],["type","text","placeholder","Type tagname ...",1,"tag-name",3,"keyup","value"],["type","checkbox",3,"click"],[1,"img-hover-zoom",3,"ngClass"],["width","100","alt","Buy",3,"src"],[1,"d-flex","justify-content-between"],[1,"code","text-start"],["href","javascript:;",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["class","text-start",4,"ngIf"],[1,"bordNone",3,"ngClass"],[1,"cart-info"],[1,"text-start"],[1,"text-center",3,"ngClass"],[1,"input-group","bg-main","mb-3","qtyInput2"],["type","button",1,"btn","bg-light-purple","border",3,"click"],["min","1",1,"form-control","form-control-sm",3,"keyup","value"],["class","menu mb-2 text-start",4,"ngFor","ngForOf"],[1,"menu","mb-2","text-start"],["href","javascript:;",1,"text-decoration-none","text-start","fw-bold",3,"click","ngClass"],["aria-hidden","true",1,"fa","fa-caret-down"],[3,"ngbCollapse"],[4,"ngFor","ngForOf"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["colspan","9"],[1,"fw-bold","text-center"],[1,"col-12","text-end"],[1,"float-right","btn","btn3","me-2",3,"click","disabled"],["aria-hidden","true",1,"fa","fa-trash"],[1,"float-right","btn","btn2","mx-1",3,"click","disabled"],["href","javascript:;","class","side-child-item p-1 text-decoration-none",3,"ngClass","click",4,"ngIf"],["href","javascript:;",1,"text-decoration-none","fw-bold",3,"click"],["href","javascript:;",1,"side-child-item","p-1","text-decoration-none",3,"click","ngClass"]],template:function(e,i){if(e&1){let n=y();a(0,"h4",6),s(1,` List of products in cart
`),c(),h(2,"hr",7),a(3,"table",8),g("treeDrop",function(_){return m(n),u(i.onDrop(_))}),a(4,"thead",9)(5,"tr",10)(6,"th"),s(7,"Item Number"),c(),a(8,"th"),s(9,"Tagname"),c(),a(10,"th",11),s(11,"Select"),c(),a(12,"th"),s(13,"Product Image"),c(),a(14,"th"),s(15,"Mfg"),c(),a(16,"th"),s(17,"Cat"),c(),a(18,"th"),s(19,"Order Code"),c(),a(20,"th",12),s(21,"Product Descriptions"),c(),a(22,"th",11),s(23,"Quantity"),c(),a(24,"th",11),s(25,"Unit Price"),c(),a(26,"th",11),s(27,"Total Price"),c()()(),a(28,"tbody",13),C(29,xe,45,58,"tr",14)(30,fe,7,3,"tr",15),c()(),C(31,Ce,7,2,"div",16)(32,ve,2,2,"ng-template",null,0,A)}e&2&&(o(28),l("ngClass",x(4,ae,i.cart.length==0)),o(),l("ngForOf",i.cart),o(),l("ngIf",i.cart.length>0),o(),l("ngIf",i.cart.length>0))},dependencies:[W,K,L,R,G,J,H,Q,ie,te,X,Z,Y],styles:[".qtyInput2[_ngcontent-%COMP%]{width:100px}.disabled[_ngcontent-%COMP%]{cursor:not-allowed}.link_disabled[_ngcontent-%COMP%], .link_disabled[_ngcontent-%COMP%]:hover{opacity:.5;cursor:not-allowed!important;color:#000!important}.dialog[_ngcontent-%COMP%]{top:50%;left:50%;width:50em;margin-top:-9em;margin-left:-25em;position:fixed;border:none!important;z-index:9999}.dialog_overlay[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;background-color:#000;opacity:.4;z-index:999}.tbody-custom[_ngcontent-%COMP%]{height:400px!important}"]})};export{re as CartComponent};
